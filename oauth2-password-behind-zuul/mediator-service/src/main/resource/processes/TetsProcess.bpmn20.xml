<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/processdef">
  <process id="TestProcess" name="TetsProcess" isExecutable="true">
    <startEvent id="startEvent1"></startEvent>
    <serviceTask id="Task2" name="Populate params with first data" activiti:async="true" activiti:exclusive="false" activiti:expression="${logger.doWork(params)}"></serviceTask>
    <sequenceFlow id="sid-99C1E017-4855-4F5E-93B5-74D70CA55E8D" sourceRef="startEvent1" targetRef="Task2"></sequenceFlow>
    <endEvent id="sid-12E964AA-59DA-45F4-A95F-5C0D42DFE958">
      <extensionElements>
        <activiti:executionListener event="end" expression="${endExecutionListener.notify(execution)}"></activiti:executionListener>
      </extensionElements>
    </endEvent>
    <sequenceFlow id="sid-263BD64F-E027-4CF5-8DA3-9D2BF4F7B992" sourceRef="Task2" targetRef="sid-BCE1573A-C2E2-42CE-80C1-AB286A3990B0"></sequenceFlow>
    <parallelGateway id="sid-BCE1573A-C2E2-42CE-80C1-AB286A3990B0"></parallelGateway>
    <serviceTask id="Task3" name="Populate params with second data aynchronous" activiti:async="true" activiti:exclusive="false" activiti:expression="${logger.doAnotherWork(params)}" activiti:resultVariableName="key"></serviceTask>
    <callActivity id="callSubFlow" name="Call Sub Flow " calledElement="SubProcess" activiti:inheritVariables="false">
      <extensionElements>
        <activiti:in source="params" target="params"></activiti:in>
        <activiti:out source="params" target="params"></activiti:out>
        <activiti:out source="random" target="random"></activiti:out>
      </extensionElements>
    </callActivity>
    <parallelGateway id="sid-54D78FD1-B051-4EEF-9120-10DC80DD1662"></parallelGateway>
    <sequenceFlow id="sid-0349D070-BB3D-4DC1-943D-C7DEA4E7C884" sourceRef="sid-54D78FD1-B051-4EEF-9120-10DC80DD1662" targetRef="PrintParams"></sequenceFlow>
    <serviceTask id="PrintParams" name="Log params" activiti:expression="${logger.printParams(params)}"></serviceTask>
    <sequenceFlow id="sid-79AE15F4-64DA-42D3-BFB9-D8CA948629A6" sourceRef="PrintParams" targetRef="sid-12E964AA-59DA-45F4-A95F-5C0D42DFE958"></sequenceFlow>
    <serviceTask id="callService1" name="Call Service 1" activiti:expression="${proxy.callService1(params)}"></serviceTask>
    <sequenceFlow id="sid-D1310289-B7F2-40ED-B7A5-B9BFA5B19899" sourceRef="callService1" targetRef="sid-54D78FD1-B051-4EEF-9120-10DC80DD1662"></sequenceFlow>
    <serviceTask id="callService2" name="Call Service 2" activiti:expression="${proxy.callService2(params)}"></serviceTask>
    <sequenceFlow id="sid-F756C520-DB52-46CC-883D-04D60468B563" sourceRef="callService2" targetRef="sid-54D78FD1-B051-4EEF-9120-10DC80DD1662"></sequenceFlow>
    <sequenceFlow id="sid-837AFDC1-0522-4705-ABD2-B062F169C823" sourceRef="Task3" targetRef="callService1"></sequenceFlow>
    <sequenceFlow id="sid-71E7D2DC-E550-4B5D-9BF0-52C4627AA21E" sourceRef="callSubFlow" targetRef="callService2"></sequenceFlow>
    <sequenceFlow id="sid-2AC41889-D9F4-4843-AC13-6701B397F223" sourceRef="sid-BCE1573A-C2E2-42CE-80C1-AB286A3990B0" targetRef="callSubFlow"></sequenceFlow>
    <sequenceFlow id="sid-B3E359A5-2D0D-495E-8519-8F031DA56442" sourceRef="sid-BCE1573A-C2E2-42CE-80C1-AB286A3990B0" targetRef="Task3"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_TestProcess">
    <bpmndi:BPMNPlane bpmnElement="TestProcess" id="BPMNPlane_TestProcess">
      <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
        <omgdc:Bounds height="30.0" width="30.0" x="75.0" y="330.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task2" id="BPMNShape_Task2">
        <omgdc:Bounds height="80.0" width="100.0" x="195.0" y="305.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sid-12E964AA-59DA-45F4-A95F-5C0D42DFE958" id="BPMNShape_sid-12E964AA-59DA-45F4-A95F-5C0D42DFE958">
        <omgdc:Bounds height="28.0" width="28.0" x="1020.0" y="331.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sid-BCE1573A-C2E2-42CE-80C1-AB286A3990B0" id="BPMNShape_sid-BCE1573A-C2E2-42CE-80C1-AB286A3990B0">
        <omgdc:Bounds height="40.0" width="40.0" x="360.0" y="325.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task3" id="BPMNShape_Task3">
        <omgdc:Bounds height="80.0" width="100.0" x="435.0" y="450.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callSubFlow" id="BPMNShape_callSubFlow">
        <omgdc:Bounds height="80.0" width="100.0" x="435.0" y="195.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sid-54D78FD1-B051-4EEF-9120-10DC80DD1662" id="BPMNShape_sid-54D78FD1-B051-4EEF-9120-10DC80DD1662">
        <omgdc:Bounds height="40.0" width="40.0" x="705.0" y="325.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="PrintParams" id="BPMNShape_PrintParams">
        <omgdc:Bounds height="80.0" width="100.0" x="855.0" y="305.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callService1" id="BPMNShape_callService1">
        <omgdc:Bounds height="80.0" width="100.0" x="600.0" y="450.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callService2" id="BPMNShape_callService2">
        <omgdc:Bounds height="80.0" width="100.0" x="600.0" y="195.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="sid-71E7D2DC-E550-4B5D-9BF0-52C4627AA21E" id="BPMNEdge_sid-71E7D2DC-E550-4B5D-9BF0-52C4627AA21E">
        <omgdi:waypoint x="535.0" y="235.0"></omgdi:waypoint>
        <omgdi:waypoint x="600.0" y="235.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-F756C520-DB52-46CC-883D-04D60468B563" id="BPMNEdge_sid-F756C520-DB52-46CC-883D-04D60468B563">
        <omgdi:waypoint x="700.0" y="235.0"></omgdi:waypoint>
        <omgdi:waypoint x="725.0" y="235.0"></omgdi:waypoint>
        <omgdi:waypoint x="725.4090909090909" y="325.40909090909093"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-79AE15F4-64DA-42D3-BFB9-D8CA948629A6" id="BPMNEdge_sid-79AE15F4-64DA-42D3-BFB9-D8CA948629A6">
        <omgdi:waypoint x="955.0" y="345.0"></omgdi:waypoint>
        <omgdi:waypoint x="1020.0" y="345.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-B3E359A5-2D0D-495E-8519-8F031DA56442" id="BPMNEdge_sid-B3E359A5-2D0D-495E-8519-8F031DA56442">
        <omgdi:waypoint x="380.0" y="365.0"></omgdi:waypoint>
        <omgdi:waypoint x="380.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="435.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-99C1E017-4855-4F5E-93B5-74D70CA55E8D" id="BPMNEdge_sid-99C1E017-4855-4F5E-93B5-74D70CA55E8D">
        <omgdi:waypoint x="105.0" y="345.0"></omgdi:waypoint>
        <omgdi:waypoint x="195.0" y="345.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-263BD64F-E027-4CF5-8DA3-9D2BF4F7B992" id="BPMNEdge_sid-263BD64F-E027-4CF5-8DA3-9D2BF4F7B992">
        <omgdi:waypoint x="295.0" y="345.1845018450185"></omgdi:waypoint>
        <omgdi:waypoint x="360.4259259259259" y="345.4259259259259"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-D1310289-B7F2-40ED-B7A5-B9BFA5B19899" id="BPMNEdge_sid-D1310289-B7F2-40ED-B7A5-B9BFA5B19899">
        <omgdi:waypoint x="700.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="725.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="725.0" y="365.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-837AFDC1-0522-4705-ABD2-B062F169C823" id="BPMNEdge_sid-837AFDC1-0522-4705-ABD2-B062F169C823">
        <omgdi:waypoint x="535.0" y="490.0"></omgdi:waypoint>
        <omgdi:waypoint x="600.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-2AC41889-D9F4-4843-AC13-6701B397F223" id="BPMNEdge_sid-2AC41889-D9F4-4843-AC13-6701B397F223">
        <omgdi:waypoint x="380.0" y="325.0"></omgdi:waypoint>
        <omgdi:waypoint x="380.0" y="235.0"></omgdi:waypoint>
        <omgdi:waypoint x="435.0" y="235.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-0349D070-BB3D-4DC1-943D-C7DEA4E7C884" id="BPMNEdge_sid-0349D070-BB3D-4DC1-943D-C7DEA4E7C884">
        <omgdi:waypoint x="745.0" y="345.0"></omgdi:waypoint>
        <omgdi:waypoint x="855.0" y="345.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>